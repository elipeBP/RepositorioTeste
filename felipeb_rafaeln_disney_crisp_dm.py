# -*- coding: utf-8 -*-
"""Felipeb_RafaelN_disney_crisp-dm.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kRXmgd9WHaLXzuc9Wi91H62TB5w7qlxd

# ðŸ”„ EstÃ¡gios do CRISP-DM com base na imagem



O conjunto de dados utilizado neste projeto reÃºne informaÃ§Ãµes sobre os filmes lanÃ§ados pela Disney entre os anos de 1937 e 2016. Ele traz uma amostra representativa da produÃ§Ã£o cinematogrÃ¡fica da empresa ao longo de quase 80 anos, incluindo tÃ­tulos clÃ¡ssicos e contemporÃ¢neos, Esse conjunto de dados permite uma anÃ¡lise histÃ³rica e financeira da atuaÃ§Ã£o da Disney no cinema, possibilitando identificar padrÃµes, tendÃªncias de gÃªnero, classificaÃ§Ãµes mais frequentes e desempenho econÃ´mico dos filmes ao longo do tempo.

## 1. Entendimento do NegÃ³cio ðŸ’¼

O objetivo deste projeto Ã© analisar dados de filmes da Disney para responder perguntas simples e objetivas.  
A partir disso, serÃ¡ possÃ­vel extrair insights Ãºteis como:

- Qual o filme mais recente?
- Qual teve maior bilheteria?
- Qual o gÃªnero mais comum?
- Quantos filmes foram lanÃ§ados depois dos anos 2000?



A base de dados utilizada foi disponibilizada no formato `.csv` e serÃ¡ carregada via Pandas.

## 2. Entendimento dos Dados ðŸ”

Nesta etapa, analisamos o conteÃºdo inicial do dataset para entender sua estrutura, tipos de dados e qualidade das informaÃ§Ãµes. TambÃ©m buscamos identificar dados ausentes, inconsistentes ou colunas que precisam de ajustes para facilitar a anÃ¡lise posterior.

No caso deste projeto, estamos lidando com informaÃ§Ãµes sobre filmes da Disney, como tÃ­tulo, data de lanÃ§amento, bilheteria e classificaÃ§Ã£o indicativa. Essa compreensÃ£o inicial Ã© fundamental para definir quais colunas serÃ£o usadas nas anÃ¡lises e o que precisarÃ¡ ser tratado antes da modelagem.

### ðŸ§¾ DicionÃ¡rio de Dados Traduzido

Para facilitar a compreensÃ£o do dataset dos filmes da Disney, segue abaixo a explicaÃ§Ã£o dos principais termos e categorias:

#### ðŸ“ Colunas principais:
- **movie_title**: TÃ­tulo original do filme (em inglÃªs)
- **release_date**: Data de lanÃ§amento
- **genre**: GÃªnero do filme (ex: Animation, Comedy, Action)
- **mpaa_rating**: ClassificaÃ§Ã£o indicativa segundo a MPAA (G, PG, PG-13, etc)
- **total_gross**: Bilheteria arrecadada no lanÃ§amento (valor nominal)
- **inflation_adjusted_gross**: Bilheteria ajustada pela inflaÃ§Ã£o

#### ðŸŽ¬ GÃªneros traduzidos:
- **Animation** â†’ AnimaÃ§Ã£o  
- **Comedy** â†’ ComÃ©dia  
- **Action** â†’ AÃ§Ã£o  
- **Adventure** â†’ Aventura  
- **Drama** â†’ Drama  
- **Fantasy** â†’ Fantasia  
- **Documentary** â†’ DocumentÃ¡rio  
- **Musical** â†’ Musical  

#### ðŸ“‹ ClassificaÃ§Ãµes indicativas (MPAA Rating):
- **G** â†’ Livre para todos os pÃºblicos (General Audiences)  
- **PG** â†’ Acompanhamento dos pais sugerido (Parental Guidance Suggested)  
- **PG-13** â†’ Algumas cenas imprÃ³prias para menores de 13 anos  
- **R** â†’ Menores de 17 anos somente acompanhados dos pais  
- **NC-17** â†’ Apenas maiores de 17 anos  
- **Not Rated / NR** â†’ Sem classificaÃ§Ã£o oficial

Esse entendimento Ã© essencial para analisar corretamente os dados, interpretar grÃ¡ficos e tirar conclusÃµes coerentes nas prÃ³ximas etapas do projeto.
"""

import pandas as pd
import matplotlib.pyplot as plt
# ler o dataset
df = pd.read_excel("/content/projetoIntegrado.xlsx")

# Visualizar uma amostra
df.head()

"""## 3. PreparaÃ§Ã£o dos Dados ðŸ§¹

Aqui transformamos a coluna `release_date` para o formato de data e identificamos dados faltantes.  
Essa etapa Ã© importante para evitar erros nas anÃ¡lises futuras.

"""

# Converter a coluna de data
df["release_date"] = pd.to_datetime(df["release_date"], errors="coerce")

# Renomear colunas para portuguÃªs
df.rename(columns={
    "movie_title": "titulo",
    "release_date": "data_lancamento",
    "genre": "genero",
    "mpaa_rating": "classificacao",
    "total_gross": "bilheteria_nominal",
    "inflation_adjusted_gross": "bilheteria_ajustada"
}, inplace=True)

# Criar uma  coluna com a dÃ©cada do lanÃ§amento
df["decada"] = (df["data_lancamento"].dt.year // 10) * 10

"""## 4. AnÃ¡lise / Modelagem ðŸ“Š

Utilizamos funÃ§Ãµes simples do Python e da biblioteca Pandas para responder perguntas relevantes sobre os dados dos filmes da Disney.

Essas perguntas envolvem, por exemplo:

Qual foi o filme com maior bilheteria?

Qual o gÃªnero mais comum?

Quantos filmes foram lanÃ§ados depois do ano 2000?

Com isso, conseguimos transformar os dados em informaÃ§Ãµes Ãºteis, que podem ajudar a entender o desempenho dos filmes da Disney ao longo do tempo.

Exemplo didÃ¡tico do cotidiano:
Imagine que vocÃª tem um caderno onde anotou o nome dos filmes que assistiu, o ano de lanÃ§amento, se vocÃª gostou ou nÃ£o, e o valor do ingresso.
Com esses dados, vocÃª pode responder perguntas como:

Qual o gÃªnero que vocÃª mais assiste?

Em que ano vocÃª viu mais filmes?

Qual ingresso foi mais caro?

"""

# DicionÃ¡rio de traduÃ§Ãµes dos tÃ­tulos mais relevantes
traducao_titulos = {
    "Zootopia": "Zootopia: Essa Cidade Ã© o Bicho",
    "Snow White and the Seven Dwarfs": "Branca de Neve e os Sete AnÃµes",
    "The Lion King": "O Rei LeÃ£o",
    "101 Dalmatians": "101 DÃ¡lmatas",
    "Frozen": "Frozen: Uma Aventura Congelante",
    "Big Hero 6": "OperaÃ§Ã£o Big Hero",
    "Beauty and the Beast": "A Bela e a Fera",
    "Finding Dory": "Procurando Dory",
    "Wreck-It Ralph": "Detona Ralph"
}



def responder_pergunta(pergunta):
    if pergunta == "1. Filme mais recente lanÃ§ado":
        titulo = df.loc[df["data_lancamento"].idxmax()]["titulo"]
        resultado = traducao_titulos.get(titulo, titulo)
        print(f"\nðŸŽ¬ FILME MAIS RECENTE LANÃ‡ADO: {resultado.upper()}")
    else:
        if pergunta == "2. Primeiro filme lanÃ§ado":
            titulo = df.loc[df["data_lancamento"].idxmin()]["titulo"]
            resultado = traducao_titulos.get(titulo, titulo)
            print(f"\nðŸŽžï¸ PRIMEIRO FILME LANÃ‡ADO: {resultado.upper()}")
        else:
            if pergunta == "3. GÃªnero mais comum":
                resultado = df["genero"].mode()[0]
                print(f"\nðŸ“š GÃŠNERO MAIS COMUM: {resultado.upper()}")
            else:
                if pergunta == "4. ClassificaÃ§Ã£o indicativa mais frequente":
                    resultado = df["classificacao"].mode()[0]
                    print(f"\nðŸ“‹ CLASSIFICAÃ‡ÃƒO MAIS COMUM: {resultado.upper()}")
                    print(f"\nðŸ’° MAIOR BILHETERIA NOMINAL: {resultado.upper()}")
                    print("â„¹ï¸ PG (Parental Guidance): Recomendado que os pais acompanhem. Pode ter temas leves ou sensÃ­veis.")
                else:
                    if pergunta == "5. Filme com maior bilheteria nominal":
                        titulo = df.loc[df["bilheteria_nominal"].idxmax()]["titulo"]
                        resultado = traducao_titulos.get(titulo, titulo)
                        print(f"\nðŸ’° MAIOR BILHETERIA NOMINAL: {resultado.upper()}")
                    else:
                        if pergunta == "6. Filme com maior bilheteria ajustada pela inflaÃ§Ã£o":
                            titulo = df.loc[df["bilheteria_ajustada"].idxmax()]["titulo"]
                            resultado = traducao_titulos.get(titulo, titulo)
                            print(f"\nðŸ’µ MAIOR BILHETERIA AJUSTADA: {resultado.upper()}")
                        else:
                            if pergunta == "7. Filmes lanÃ§ados apÃ³s 2000":
                                resultado = df[df["data_lancamento"].dt.year > 2000].shape[0]
                                print(f"\nðŸ“… {resultado} FILMES LANÃ‡ADOS APÃ“S O ANO 2000")
                            else:
                                if pergunta == "8. Filmes lanÃ§ados antes de 2000":
                                    resultado = df[df["data_lancamento"].dt.year < 2000].shape[0]
                                    print(f"\nðŸ“¼ {resultado} FILMES LANÃ‡ADOS ANTES DO ANO 2000")
                                else:
                                    if pergunta == "9. Total de filmes no dataset":
                                        resultado = df.shape[0]
                                        print(f"\nðŸŽ¥ TOTAL DE FILMES NO CONJUNTO DE DADOS: {resultado}")
                                    else:
                                        if pergunta == "10. MÃ©dia de arrecadaÃ§Ã£o nominal":
                                            resultado = round(df["bilheteria_nominal"].mean(), 2)
                                            print(f"\nðŸ“Š MÃ‰DIA DE ARRECADAÃ‡ÃƒO NOMINAL: US$: {resultado:,.3f}")
                                        else:
                                            print("\nâŒ PERGUNTA INVÃLIDA.")

"""## 5. ValidaÃ§Ã£o âœ…

Todos os blocos de cÃ³digo foram testados no Google Colab e executaram corretamente, sem apresentar erros.  
As respostas foram conferidas manualmente com os dados do DataFrame, e os resultados correspondem Ã  realidade esperada:

- O filme com maior bilheteria
- Filme mais recente lanÃ§ado(1937-2016)
- O nÃºmero total de filmes corresponde ao total de linhas do dataset.

AlÃ©m disso, o menu de perguntas foi testado com todos os nÃºmeros de 1 a 10, retornando a resposta correta para cada opÃ§Ã£o.

Como se trata de uma anÃ¡lise descritiva simples, **nÃ£o hÃ¡ modelos preditivos a validar**, apenas verificaÃ§Ã£o da lÃ³gica e da integridade dos dados.



"""

df.loc[df["bilheteria_nominal"].idxmax()]["titulo"]

df["data_lancamento"].max()
df["titulo"].loc[df["data_lancamento"].idxmax()]

validacao = df.shape[0]
print(f"O dataset contÃ©m {validacao}")

"""##6. ImplantaÃ§Ã£o / ApresentaÃ§Ã£o ðŸ§¾

Todas as etapas foram aplicadas: desde a limpeza e traduÃ§Ã£o dos dados atÃ© a apresentaÃ§Ã£o visual dos resultados.

"""

def menu_perguntas():
    # DicionÃ¡rio com perguntas
    perguntas_dict = {
        "1": "1. Filme mais recente lanÃ§ado",
        "2": "2. Primeiro filme lanÃ§ado",
        "3": "3. GÃªnero mais comum",
        "4": "4. ClassificaÃ§Ã£o indicativa mais frequente",
        "5": "5. Filme com maior bilheteria nominal",
        "6": "6. Filme com maior bilheteria ajustada pela inflaÃ§Ã£o",
        "7": "7. Filmes lanÃ§ados apÃ³s 2000",
        "8": "8. Filmes lanÃ§ados antes de 2000",
        "9": "9. Total de filmes no dataset",
        "10": "10. MÃ©dia de arrecadaÃ§Ã£o nominal"
    }

    while True:
        # Mostrar menu
        print("\nðŸ“Œ Escolha uma das perguntas abaixo (ou digite 'sair' para encerrar):\n")
        for key, val in perguntas_dict.items():
            print(f"{key} - {val[3:]}")

        # Entrada
        opcao = input("\nDigite o nÃºmero da pergunta ou 'sair': ").strip()

        if opcao.lower() == 'sair':
            print("\nâœ… Programa encerrado.")
            break

        # Responde
        pergunta_escolhida = perguntas_dict.get(opcao)
        if pergunta_escolhida:
            responder_pergunta(pergunta_escolhida)
        else:
            print("âŒ NÃºmero invÃ¡lido. Tente novamente.")

menu_perguntas()


# Calcular mÃ©dia de bilheteria por classificaÃ§Ã£o
df.groupby("classificacao")["bilheteria_nominal"].mean().sort_values(ascending=False).plot(
    kind="bar",
    title="MÃ©dia de Bilheteria por ClassificaÃ§Ã£o Indicativa",
    xlabel="ClassificaÃ§Ã£o",
    ylabel="Bilheteria MÃ©dia",
    color="lightblue",
    edgecolor="black"
)



# Criar uma  coluna com a dÃ©cada do lanÃ§amento
#df["decada"] = (df["data_lancamento"].dt.year // 10) * 10

# Contar quantos filmes tem por dÃ©cada
filmes_por_decada = df["decada"].value_counts().sort_index()

#  grÃ¡fico
plt.figure(figsize=(20, 6))
filmes_por_decada.plot(kind="bar", color="red", edgecolor="black")

plt.title("ðŸŽ¬ Quantidade de Filmes por DÃ©cada", fontsize=14)
plt.xlabel("DÃ©cada", fontsize=12)
plt.ylabel("Quantidade de Filmes", fontsize=12)
plt.xticks(rotation=45)
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.tight_layout()
plt.show()